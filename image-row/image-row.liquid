{{ 'component-hub-slideshow.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .image-row-section {
    margin: 3rem 0;
  }

  .image-row__heading {
    text-align: center;
    margin-bottom: 2rem;
  }

  .image-row__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
    align-items: start;
  }

  .image-row__item {
    display: flex;
    flex-direction: column;
  }

  .image-row__item a {
    display: block;
  }

  .image-row__image {
    width: 100%;
    height: auto;
    object-fit: contain;
    display: block;
  }

  .image-row__caption {
    margin-top: 1rem;
    text-align: center;
    font-size: 1.4rem;
    color: rgba(var(--color-foreground), 0.75);
  }

  .image-row__slider {
    position: relative;
  }

  .image-row__slider .swiper-slide {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .image-row__slider .image-row__image {
    max-width: 100%;
    height: auto;
  }

  @media screen and (min-width: 990px) {
    .image-row__grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  @media screen and (min-width: 750px) and (max-width: 989px) {
    .image-row__grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
{%- endstyle -%}

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<section class="article-template__section--inner image-row-section" id="{{ section.settings.section_id }}" data-section-id="{{ section.id }}">
  <div class="page-width">
    {% if section.settings.heading != blank %}
      <{{ section.settings.heading_level }} class="image-row__heading" style="color: {{ section.settings.heading_color }};">
        {{ section.settings.heading }}
      </{{ section.settings.heading_level }}>
    {% endif %}

    <div class="desktop-only image-row__grid">
      {% if section.settings.image_1 %}
        <div class="image-row__item">
          {% if section.settings.image_1_url != blank %}
            <a href="{{ section.settings.image_1_url }}" {% if section.settings.image_1_url_new_tab %}target="_blank"{% endif %}>
              <img
                class="image-row__image"
                srcset="
                  {% if section.settings.image_1.width >= 350 %}{{ section.settings.image_1 | image_url: width: 350 }} 350w,{% endif %}
                  {% if section.settings.image_1.width >= 750 %}{{ section.settings.image_1 | image_url: width: 750 }} 750w,{% endif %}
                  {% if section.settings.image_1.width >= 1100 %}{{ section.settings.image_1 | image_url: width: 1100 }} 1100w,{% endif %}
                  {{ section.settings.image_1 | image_url }} {{ section.settings.image_1.width }}w
                "
                sizes="(min-width: 990px) calc((100vw - 10rem) / 3), (min-width: 750px) calc((100vw - 10rem) / 2), 100vw"
                src="{{ section.settings.image_1 | image_url: width: 750 }}"
                loading="lazy"
                width="{{ section.settings.image_1.width }}"
                height="{{ section.settings.image_1.height }}"
                alt="{{ section.settings.image_1.alt | escape }}"
              >
            </a>
          {% else %}
            <img
              class="image-row__image"
              srcset="
                {% if section.settings.image_1.width >= 350 %}{{ section.settings.image_1 | image_url: width: 350 }} 350w,{% endif %}
                {% if section.settings.image_1.width >= 750 %}{{ section.settings.image_1 | image_url: width: 750 }} 750w,{% endif %}
                {% if section.settings.image_1.width >= 1100 %}{{ section.settings.image_1 | image_url: width: 1100 }} 1100w,{% endif %}
                {{ section.settings.image_1 | image_url }} {{ section.settings.image_1.width }}w
              "
              sizes="(min-width: 990px) calc((100vw - 10rem) / 3), (min-width: 750px) calc((100vw - 10rem) / 2), 100vw"
              src="{{ section.settings.image_1 | image_url: width: 750 }}"
              loading="lazy"
              width="{{ section.settings.image_1.width }}"
              height="{{ section.settings.image_1.height }}"
              alt="{{ section.settings.image_1.alt | escape }}"
            >
          {% endif %}
          {% if section.settings.image_1_caption != blank %}
            <p class="image-row__caption">{{ section.settings.image_1_caption }}</p>
          {% endif %}
        </div>
      {% endif %}

      {% if section.settings.image_2 %}
        <div class="image-row__item">
          {% if section.settings.image_2_url != blank %}
            <a href="{{ section.settings.image_2_url }}" {% if section.settings.image_2_url_new_tab %}target="_blank"{% endif %}>
              <img
                class="image-row__image"
                srcset="
                  {% if section.settings.image_2.width >= 350 %}{{ section.settings.image_2 | image_url: width: 350 }} 350w,{% endif %}
                  {% if section.settings.image_2.width >= 750 %}{{ section.settings.image_2 | image_url: width: 750 }} 750w,{% endif %}
                  {% if section.settings.image_2.width >= 1100 %}{{ section.settings.image_2 | image_url: width: 1100 }} 1100w,{% endif %}
                  {{ section.settings.image_2 | image_url }} {{ section.settings.image_2.width }}w
                "
                sizes="(min-width: 990px) calc((100vw - 10rem) / 3), (min-width: 750px) calc((100vw - 10rem) / 2), 100vw"
                src="{{ section.settings.image_2 | image_url: width: 750 }}"
                loading="lazy"
                width="{{ section.settings.image_2.width }}"
                height="{{ section.settings.image_2.height }}"
                alt="{{ section.settings.image_2.alt | escape }}"
              >
            </a>
          {% else %}
            <img
              class="image-row__image"
              srcset="
                {% if section.settings.image_2.width >= 350 %}{{ section.settings.image_2 | image_url: width: 350 }} 350w,{% endif %}
                {% if section.settings.image_2.width >= 750 %}{{ section.settings.image_2 | image_url: width: 750 }} 750w,{% endif %}
                {% if section.settings.image_2.width >= 1100 %}{{ section.settings.image_2 | image_url: width: 1100 }} 1100w,{% endif %}
                {{ section.settings.image_2 | image_url }} {{ section.settings.image_2.width }}w
              "
              sizes="(min-width: 990px) calc((100vw - 10rem) / 3), (min-width: 750px) calc((100vw - 10rem) / 2), 100vw"
              src="{{ section.settings.image_2 | image_url: width: 750 }}"
              loading="lazy"
              width="{{ section.settings.image_2.width }}"
              height="{{ section.settings.image_2.height }}"
              alt="{{ section.settings.image_2.alt | escape }}"
            >
          {% endif %}
          {% if section.settings.image_2_caption != blank %}
            <p class="image-row__caption">{{ section.settings.image_2_caption }}</p>
          {% endif %}
        </div>
      {% endif %}

      {% if section.settings.image_3 %}
        <div class="image-row__item">
          {% if section.settings.image_3_url != blank %}
            <a href="{{ section.settings.image_3_url }}" {% if section.settings.image_3_url_new_tab %}target="_blank"{% endif %}>
              <img
                class="image-row__image"
                srcset="
                  {% if section.settings.image_3.width >= 350 %}{{ section.settings.image_3 | image_url: width: 350 }} 350w,{% endif %}
                  {% if section.settings.image_3.width >= 750 %}{{ section.settings.image_3 | image_url: width: 750 }} 750w,{% endif %}
                  {% if section.settings.image_3.width >= 1100 %}{{ section.settings.image_3 | image_url: width: 1100 }} 1100w,{% endif %}
                  {{ section.settings.image_3 | image_url }} {{ section.settings.image_3.width }}w
                "
                sizes="(min-width: 990px) calc((100vw - 10rem) / 3), (min-width: 750px) calc((100vw - 10rem) / 2), 100vw"
                src="{{ section.settings.image_3 | image_url: width: 750 }}"
                loading="lazy"
                width="{{ section.settings.image_3.width }}"
                height="{{ section.settings.image_3.height }}"
                alt="{{ section.settings.image_3.alt | escape }}"
              >
            </a>
          {% else %}
            <img
              class="image-row__image"
              srcset="
                {% if section.settings.image_3.width >= 350 %}{{ section.settings.image_3 | image_url: width: 350 }} 350w,{% endif %}
                {% if section.settings.image_3.width >= 750 %}{{ section.settings.image_3 | image_url: width: 750 }} 750w,{% endif %}
                {% if section.settings.image_3.width >= 1100 %}{{ section.settings.image_3 | image_url: width: 1100 }} 1100w,{% endif %}
                {{ section.settings.image_3 | image_url }} {{ section.settings.image_3.width }}w
              "
              sizes="(min-width: 990px) calc((100vw - 10rem) / 3), (min-width: 750px) calc((100vw - 10rem) / 2), 100vw"
              src="{{ section.settings.image_3 | image_url: width: 750 }}"
              loading="lazy"
              width="{{ section.settings.image_3.width }}"
              height="{{ section.settings.image_3.height }}"
              alt="{{ section.settings.image_3.alt | escape }}"
            >
          {% endif %}
          {% if section.settings.image_3_caption != blank %}
            <p class="image-row__caption">{{ section.settings.image_3_caption }}</p>
          {% endif %}
        </div>
      {% endif %}
    </div>

    <div class="mobile-only image-row__slider">
      <div class="swiper image-row-swiper-{{ section.id }}">
        <div class="swiper-wrapper">
          {% if section.settings.image_1 %}
            <div class="swiper-slide">
              {% if section.settings.image_1_url != blank %}
                <a href="{{ section.settings.image_1_url }}" {% if section.settings.image_1_url_new_tab %}target="_blank"{% endif %}>
                  <img
                    class="image-row__image"
                    srcset="
                      {% if section.settings.image_1.width >= 350 %}{{ section.settings.image_1 | image_url: width: 350 }} 350w,{% endif %}
                      {% if section.settings.image_1.width >= 750 %}{{ section.settings.image_1 | image_url: width: 750 }} 750w,{% endif %}
                      {{ section.settings.image_1 | image_url }} {{ section.settings.image_1.width }}w
                    "
                    sizes="100vw"
                    src="{{ section.settings.image_1 | image_url: width: 750 }}"
                    loading="lazy"
                    width="{{ section.settings.image_1.width }}"
                    height="{{ section.settings.image_1.height }}"
                    alt="{{ section.settings.image_1.alt | escape }}"
                  >
                </a>
              {% else %}
                <img
                  class="image-row__image"
                  srcset="
                    {% if section.settings.image_1.width >= 350 %}{{ section.settings.image_1 | image_url: width: 350 }} 350w,{% endif %}
                    {% if section.settings.image_1.width >= 750 %}{{ section.settings.image_1 | image_url: width: 750 }} 750w,{% endif %}
                    {{ section.settings.image_1 | image_url }} {{ section.settings.image_1.width }}w
                  "
                  sizes="100vw"
                  src="{{ section.settings.image_1 | image_url: width: 750 }}"
                  loading="lazy"
                  width="{{ section.settings.image_1.width }}"
                  height="{{ section.settings.image_1.height }}"
                  alt="{{ section.settings.image_1.alt | escape }}"
                >
              {% endif %}
              {% if section.settings.image_1_caption != blank %}
                <p class="image-row__caption">{{ section.settings.image_1_caption }}</p>
              {% endif %}
            </div>
          {% endif %}

          {% if section.settings.image_2 %}
            <div class="swiper-slide">
              {% if section.settings.image_2_url != blank %}
                <a href="{{ section.settings.image_2_url }}" {% if section.settings.image_2_url_new_tab %}target="_blank"{% endif %}>
                  <img
                    class="image-row__image"
                    srcset="
                      {% if section.settings.image_2.width >= 350 %}{{ section.settings.image_2 | image_url: width: 350 }} 350w,{% endif %}
                      {% if section.settings.image_2.width >= 750 %}{{ section.settings.image_2 | image_url: width: 750 }} 750w,{% endif %}
                      {{ section.settings.image_2 | image_url }} {{ section.settings.image_2.width }}w
                    "
                    sizes="100vw"
                    src="{{ section.settings.image_2 | image_url: width: 750 }}"
                    loading="lazy"
                    width="{{ section.settings.image_2.width }}"
                    height="{{ section.settings.image_2.height }}"
                    alt="{{ section.settings.image_2.alt | escape }}"
                  >
                </a>
              {% else %}
                <img
                  class="image-row__image"
                  srcset="
                    {% if section.settings.image_2.width >= 350 %}{{ section.settings.image_2 | image_url: width: 350 }} 350w,{% endif %}
                    {% if section.settings.image_2.width >= 750 %}{{ section.settings.image_2 | image_url: width: 750 }} 750w,{% endif %}
                    {{ section.settings.image_2 | image_url }} {{ section.settings.image_2.width }}w
                  "
                  sizes="100vw"
                  src="{{ section.settings.image_2 | image_url: width: 750 }}"
                  loading="lazy"
                  width="{{ section.settings.image_2.width }}"
                  height="{{ section.settings.image_2.height }}"
                  alt="{{ section.settings.image_2.alt | escape }}"
                >
              {% endif %}
              {% if section.settings.image_2_caption != blank %}
                <p class="image-row__caption">{{ section.settings.image_2_caption }}</p>
              {% endif %}
            </div>
          {% endif %}

          {% if section.settings.image_3 %}
            <div class="swiper-slide">
              {% if section.settings.image_3_url != blank %}
                <a href="{{ section.settings.image_3_url }}" {% if section.settings.image_3_url_new_tab %}target="_blank"{% endif %}>
                  <img
                    class="image-row__image"
                    srcset="
                      {% if section.settings.image_3.width >= 350 %}{{ section.settings.image_3 | image_url: width: 350 }} 350w,{% endif %}
                      {% if section.settings.image_3.width >= 750 %}{{ section.settings.image_3 | image_url: width: 750 }} 750w,{% endif %}
                      {{ section.settings.image_3 | image_url }} {{ section.settings.image_3.width }}w
                    "
                    sizes="100vw"
                    src="{{ section.settings.image_3 | image_url: width: 750 }}"
                    loading="lazy"
                    width="{{ section.settings.image_3.width }}"
                    height="{{ section.settings.image_3.height }}"
                    alt="{{ section.settings.image_3.alt | escape }}"
                  >
                </a>
              {% else %}
                <img
                  class="image-row__image"
                  srcset="
                    {% if section.settings.image_3.width >= 350 %}{{ section.settings.image_3 | image_url: width: 350 }} 350w,{% endif %}
                    {% if section.settings.image_3.width >= 750 %}{{ section.settings.image_3 | image_url: width: 750 }} 750w,{% endif %}
                    {{ section.settings.image_3 | image_url }} {{ section.settings.image_3.width }}w
                  "
                  sizes="100vw"
                  src="{{ section.settings.image_3 | image_url: width: 750 }}"
                  loading="lazy"
                  width="{{ section.settings.image_3.width }}"
                  height="{{ section.settings.image_3.height }}"
                  alt="{{ section.settings.image_3.alt | escape }}"
                >
              {% endif %}
              {% if section.settings.image_3_caption != blank %}
                <p class="image-row__caption">{{ section.settings.image_3_caption }}</p>
              {% endif %}
            </div>
          {% endif %}
        </div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const sectionId = '{{ section.id }}';
    const swiperElement = document.querySelector('.image-row-swiper-' + sectionId);
    
    if (swiperElement && window.Swiper) {
      new Swiper('.image-row-swiper-' + sectionId, {
        slidesPerView: 1,
        spaceBetween: 20,
        navigation: {
          nextEl: '.image-row-swiper-' + sectionId + ' .swiper-button-next',
          prevEl: '.image-row-swiper-' + sectionId + ' .swiper-button-prev',
        },
        loop: false,
      });
    }
  });
</script>

{% schema %}
{
  "name": "Image Row",
  "class": "image-row-section",
  "settings": [
    {
      "type": "text",
      "id": "section_id",
      "label": "Section ID",
      "info": "Add a unique ID to the section that is in lowercase and has no spaces or special characters other than dashes"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "select",
      "id": "heading_level",
      "label": "Heading Level",
      "default": "h2",
      "options": [
        {
          "value": "h2",
          "label": "Heading 2"
        },
        {
          "value": "h3",
          "label": "Heading 3"
        },
        {
          "value": "h4",
          "label": "Heading 4"
        }
      ]
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#000"
    },
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Image 1"
    },
    {
      "type": "text",
      "id": "image_1_caption",
      "label": "Image 1 Caption"
    },
    {
      "type": "url",
      "id": "image_1_url",
      "label": "Image 1 URL"
    },
    {
      "type": "checkbox",
      "id": "image_1_url_new_tab",
      "label": "Open Image 1 URL in a new tab",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Image 2"
    },
    {
      "type": "text",
      "id": "image_2_caption",
      "label": "Image 2 Caption"
    },
    {
      "type": "url",
      "id": "image_2_url",
      "label": "Image 2 URL"
    },
    {
      "type": "checkbox",
      "id": "image_2_url_new_tab",
      "label": "Open Image 2 URL in a new tab",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Image 3"
    },
    {
      "type": "text",
      "id": "image_3_caption",
      "label": "Image 3 Caption"
    },
    {
      "type": "url",
      "id": "image_3_url",
      "label": "Image 3 URL"
    },
    {
      "type": "checkbox",
      "id": "image_3_url_new_tab",
      "label": "Open Image 3 URL in a new tab",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Image Row"
    }
  ]
}
{% endschema %}

